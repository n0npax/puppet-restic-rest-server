1. Fix linting and idents
2. refactor
3. Test if changing params works fine
4. implement support for tls files
